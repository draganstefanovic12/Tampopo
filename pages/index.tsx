import type { NextPage } from "next";
import Head from "next/head";
import Hero from "../components/Hero/Hero";
import styles from "../styles/Home.module.css";
import axios from "axios";
import MangasSection from "../components/MangasSection/MangasSection";
import { topRated, recentlyUpdated } from "../assets/links";

export type Manga = {
  id: string;
  relationships: Relationship[];
  attributes: {
    title: {
      en: string;
    };
  };
};

type Relationship = {
  type: string;
  attributes: {
    fileName: string;
  };
};

type FetchedMangas = {
  topRated: {
    data: Manga[];
  };
  newReleases: {
    data: Manga[];
  };
};

const Home: NextPage<FetchedMangas> = (props: FetchedMangas) => {
  return (
    <div className={styles.container}>
      <Head>
        <title>Manilist</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Hero />
      <MangasSection props={props.topRated.data} />
      <MangasSection props={props.newReleases.data} />
    </div>
  );
};

export const getStaticProps = async () => {
  const link = topRated;
  const tpRated = await axios.get(link);

  const link2 = recentlyUpdated;
  const newReleases = await axios.get(link2);

  return {
    props: {
      topRated: tpRated.data,
      newReleases: newReleases.data,
    },
  };
};

export default Home;
